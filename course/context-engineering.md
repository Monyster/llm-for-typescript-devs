# Context Engineering ‚Äî –Ω–æ–≤–∞ –ø–∞—Ä–∞–¥–∏–≥–º–∞ —Ä–æ–±–æ—Ç–∏ –∑ LLM

> ‚è± ~2 –≥–æ–¥–∏–Ω–∏ | üü° Middle | –ü–æ—Ç—Ä—ñ–±–µ–Ω: [–ú–æ–¥—É–ª—å 04 ‚Äî –ü—Ä–æ–º–ø—Ç-—ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è](04-prompting.md)
>
> üìñ Deep dive: [KB: Context Engineering](../kb/advanced/context-engineering-deep-dive.md)

## üí∞ –ë—ñ–∑–Ω–µ—Å-—Ü—ñ–Ω–Ω—ñ—Å—Ç—å

**–ü—Ä–æ–±–ª–µ–º–∞ –∫–ª—ñ—î–Ω—Ç–∞:** AI-–∞–≥–µ–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–µ—Ç–æ—á–Ω–æ, "–≥–∞–ª—é—Ü–∏–Ω—É—î", –∑–∞–±—É–≤–∞—î –∫–æ–Ω—Ç–µ–∫—Å—Ç. –ë—ñ–∑–Ω–µ—Å –Ω–µ –¥–æ–≤—ñ—Ä—è—î —Å–∏—Å—Ç–µ–º—ñ.  
**–†—ñ—à–µ–Ω–Ω—è –∑ —Ü—å–æ–≥–æ –º–æ–¥—É–ª—è:** –Ü–Ω–∂–µ–Ω–µ—Ä–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ —Ç–æ–≥–æ, –©–û –±–∞—á–∏—Ç—å –º–æ–¥–µ–ª—å, –∑–∞–º—ñ—Å—Ç—å –º–∞–≥—ñ—á–Ω–∏—Ö –ø—Ä–æ–º–ø—Ç—ñ–≤.  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 57% –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π –º–∞—é—Ç—å AI-–∞–≥–µ–Ω—Ç—ñ–≤ –≤ production (LangChain 2025), –∞–ª–µ 32% –Ω–∞–∑–∏–≤–∞—é—Ç—å —è–∫—ñ—Å—Ç—å –≥–æ–ª–æ–≤–Ω–æ—é –ø—Ä–æ–±–ª–µ–º–æ—é. Context engineering ‚Äî —Ü–µ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ "–ø—Ä–∞—Ü—é—î —É –¥–µ–º–æ" —ñ "–ø—Ä–∞—Ü—é—î –≤ production".  
**–Ø–∫ –ø—Ä–æ–¥–∞—Ç–∏:** "–ê—É–¥–∏—Ç —ñ –ø–µ—Ä–µ–±—É–¥–æ–≤–∞ context pipeline –≤–∞—à–æ–≥–æ AI-–ø—Ä–æ–¥—É–∫—Ç—É" ‚Äî –ø—Ä–æ–µ–∫—Ç –Ω–∞ $5‚Äì15K.

---

## –©–æ —Å—Ç–∞–ª–æ—Å—å –∑ –ø—Ä–æ–º–ø—Ç-—ñ–Ω–∂–µ–Ω–µ—Ä—ñ—î—é

–ü—Ä–æ–º–ø—Ç-—ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è –Ω—ñ–∫—É–¥–∏ –Ω–µ –∑–Ω–∏–∫–ª–∞. –í–æ–Ω–∞ —Å—Ç–∞–ª–∞ **–ø—ñ–¥—Ä–æ–∑–¥—ñ–ª–æ–º** –±—ñ–ª—å—à–æ—ó –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∏.

–£ 2023 —Ñ–æ–∫—É—Å –±—É–≤ –Ω–∞ —Ç–æ–º—É, –Ø–ö –Ω–∞–ø–∏—Å–∞—Ç–∏ –∑–∞–ø–∏—Ç ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Å–ª–æ–≤–∞, —Ñ–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è, –º–∞–≥—ñ—á–Ω—ñ —à–∞–±–ª–æ–Ω–∏. –£ 2025‚Äì2026 —Ñ–æ–∫—É—Å –∑–º—ñ—Å—Ç–∏–≤—Å—è –Ω–∞ —Ç–µ, –©–û –ø–æ–¥–∞—Ç–∏ –Ω–∞ –≤—Ö—ñ–¥ –º–æ–¥–µ–ª—ñ ‚Äî —è–∫—ñ –¥–∞–Ω—ñ, –≤ —è–∫–æ–º—É –ø–æ—Ä—è–¥–∫—É, –≤ —è–∫–æ–º—É –æ–±—Å—è–∑—ñ, –≤ —è–∫–∏–π –º–æ–º–µ–Ω—Ç.

Andrej Karpathy (ex-OpenAI): *"In every serious LLM application, context engineering is the delicate art and science of filling the context window with just the right information for each step."*

Tobi L√ºtke (CEO Shopify): *"Context engineering ‚Äî the art of providing all the context for the task to be plausibly solvable by the LLM."*

Anthropic (–≤–µ—Ä–µ—Å–µ–Ω—å 2025): *"Building with LLMs is becoming less about finding the right words and more about answering the broader question: what configuration of context is most likely to generate our model's desired behavior?"*

### –ü—Ä–æ–º–ø—Ç-—ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è vs Context Engineering

```
–ü—Ä–æ–º–ø—Ç-—ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è:
  "–ù–∞–ø–∏—à–∏ system prompt —è–∫–∏–π –ø—Ä–∞—Ü—é—î" ‚Üí –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞ –∑–∞–¥–∞—á–∞

Context Engineering:
  "–°–ø—Ä–æ–µ–∫—Ç—É–π —Å–∏—Å—Ç–µ–º—É —è–∫–∞ –≤ –∫–æ–∂–Ω–∏–π –º–æ–º–µ–Ω—Ç —á–∞—Å—É
   –ø–æ–¥–∞—î –º–æ–¥–µ–ª—ñ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó" ‚Üí –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞
```

| –ê—Å–ø–µ–∫—Ç | Prompt Engineering | Context Engineering |
|--------|-------------------|-------------------|
| –§–æ–∫—É—Å | –Ø–∫ —Å—Ñ–æ—Ä–º—É–ª—é–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç | –©–æ –ø–æ–¥–∞—Ç–∏ –Ω–∞ –≤—Ö—ñ–¥ –º–æ–¥–µ–ª—ñ |
| –ú–∞—Å—à—Ç–∞–± | –û–¥–∏–Ω –ø—Ä–æ–º–ø—Ç | –í—Å—è —Å–∏—Å—Ç–µ–º–∞: –ø—Ä–æ–º–ø—Ç + –¥–∞–Ω—ñ + –ø–∞–º'—è—Ç—å + —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ |
| –ö–æ–ª–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å | –ü—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ñ –ø—Ä–æ–º–ø—Ç—É | –ü—Ä–∏ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—ñ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ |
| –†–µ–∑—É–ª—å—Ç–∞—Ç | –ö—Ä–∞—â–∏–π –ø—Ä–æ–º–ø—Ç | –ö—Ä–∞—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ –∫–æ–∂–Ω–æ–º—É –∫—Ä–æ—Ü—ñ |

---

## –ê–Ω–∞—Ç–æ–º—ñ—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

–ö–æ–ª–∏ –º–æ–¥–µ–ª—å –æ—Ç—Ä–∏–º—É—î –∑–∞–ø–∏—Ç, –≤–æ–Ω–∞ –±–∞—á–∏—Ç—å **–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–µ –≤—ñ–∫–Ω–æ** ‚Äî –æ–±–º–µ–∂–µ–Ω–∏–π –Ω–∞–±—ñ—Ä —Ç–æ–∫–µ–Ω—ñ–≤. –í—Å–µ —â–æ –≤ –Ω—å–æ–º—É ‚Äî —Ü–µ –í–°–ï —â–æ –º–æ–¥–µ–ª—å –∑–Ω–∞—î –ø—Ä–æ –≤–∞—à—É –∑–∞–¥–∞—á—É.

Context Engineering ‚Äî —Ü–µ –¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–∏–º, —â–æ –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ —Ü–µ –≤—ñ–∫–Ω–æ.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–µ –≤—ñ–∫–Ω–æ (200K —Ç–æ–∫–µ–Ω—ñ–≤)     ‚îÇ
‚îÇ                                                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ System Prompt                              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ –•—Ç–æ —Ç–∏, —è–∫ –ø–æ–≤–æ–¥–∏—Ç–∏—Å—å, –ø—Ä–∞–≤–∏–ª–∞             ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ –î–æ—Å—Ç—É–ø–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ (tools)               ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ –û–ø–∏—Å–∏ —Ñ—É–Ω–∫—Ü—ñ–π, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏                   ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ –û—Ç—Ä–∏–º–∞–Ω—ñ –¥–∞–Ω—ñ (RAG, MCP, API)              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ –î–æ–∫—É–º–µ–Ω—Ç–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É               ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ –Ü—Å—Ç–æ—Ä—ñ—è —Ä–æ–∑–º–æ–≤–∏                            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, tool results        ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ –ü–æ—Ç–æ—á–Ω–∏–π –∑–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞                 ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–ª—é—á–æ–≤–∏–π —ñ–Ω—Å–∞–π—Ç:** –ö–æ–∂–µ–Ω –∑ —Ü–∏—Ö –±–ª–æ–∫—ñ–≤ ‚Äî —Ü–µ —ñ–Ω–∂–µ–Ω–µ—Ä–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è. –ù–µ "–ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–π –≤—Å–µ —â–æ —î", –∞ "–æ–±–µ—Ä–∏ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–º —Å–∏–≥–Ω–∞–ª–æ–º".

---

## –ü'—è—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

### 1. System Prompt ‚Äî –ø–æ—Å—Ç—ñ–π–Ω–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å

```typescript
import { generateText } from 'ai';
import { openai } from '@ai-sdk/openai';

const systemPrompt = `–¢–∏ ‚Äî AI-–∞—Å–∏—Å—Ç–µ–Ω—Ç –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ TechShop.

## –ü—Ä–∞–≤–∏–ª–∞
- –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π –¢–Ü–õ–¨–ö–ò –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞–¥–∞–Ω–æ—ó –±–∞–∑–∏ –∑–Ω–∞–Ω—å
- –Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–µ–º–∞—î –≤ –±–∞–∑—ñ ‚Äî —Å–∫–∞–∂–∏ "–Ø –Ω–µ –º–∞—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó" —ñ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–π –∑–≤'—è–∑–∞—Ç–∏—Å—å –∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º
- –ù—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–≥–∞–¥—É–π —Ü—ñ–Ω–∏, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å, —Ç–µ—Ä–º—ñ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

## –¢–æ–Ω
- –í–≤—ñ—á–ª–∏–≤–∏–π, –ª–∞–∫–æ–Ω—ñ—á–Ω–∏–π
- –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –º–æ–≤–∞
- –ú–∞–∫—Å–∏–º—É–º 3 —Ä–µ—á–µ–Ω–Ω—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

## –ï—Å–∫–∞–ª–∞—Ü—ñ—è
- –ó–∞–ø–∏—Ç –ø—Ä–æ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≥—Ä–æ—à–µ–π ‚Üí –µ—Å–∫–∞–ª—é–π –Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- –°–∫–∞—Ä–≥–∞ ‚Üí –µ—Å–∫–∞–ª—é–π –Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- –¢–µ—Ö–Ω—ñ—á–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è ‚Üí —à—É–∫–∞–π –≤ –±–∞–∑—ñ –∑–Ω–∞–Ω—å`;
```

–¶–µ —Ç–µ —â–æ –≤–∏ –≤–∂–µ –∑–Ω–∞—î—Ç–µ –∑ –ø—Ä–æ–º–ø—Ç-—ñ–Ω–∂–µ–Ω–µ—Ä—ñ—ó (–ú–æ–¥—É–ª—å 04). –†—ñ–∑–Ω–∏—Ü—è –≤ —Ç–æ–º—É, —â–æ system prompt ‚Äî –ª–∏—à–µ –û–î–ò–ù –∑ –ø'—è—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤.

### 2. Tools ‚Äî –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∞–≥–µ–Ω—Ç–∞

Anthropic —Ä–µ–∫–æ–º–µ–Ω–¥—É—î: –º–µ–Ω—à–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –∑ —á—ñ—Ç–∫–∏–º–∏ –æ–ø–∏—Å–∞–º–∏ –∫—Ä–∞—â–µ –Ω—ñ–∂ –±–∞–≥–∞—Ç–æ —Ä–æ–∑–º–∏—Ç–∏—Ö.

```typescript
import { tool } from 'ai';
import { z } from 'zod';

// ‚úÖ –ß—ñ—Ç–∫–∏–π, –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤
const tools = {
  searchKnowledgeBase: tool({
    description: '–®—É–∫–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É –±–∞–∑—ñ –∑–Ω–∞–Ω—å TechShop. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –¥–ª—è –ø–∏—Ç–∞–Ω—å –ø—Ä–æ –ø—Ä–æ–¥—É–∫—Ç–∏, –¥–æ—Å—Ç–∞–≤–∫—É, –≥–∞—Ä–∞–Ω—Ç—ñ—é.',
    parameters: z.object({
      query: z.string().describe('–ü–æ—à—É–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é'),
    }),
    execute: async ({ query }) => {
      return await vectorSearch(query, { topK: 3 });
    },
  }),

  checkOrderStatus: tool({
    description: '–ü–µ—Ä–µ–≤—ñ—Ä—è—î —Å—Ç–∞—Ç—É—Å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑–∞ –Ω–æ–º–µ—Ä–æ–º. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –¢–Ü–õ–¨–ö–ò –∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –Ω–∞–∑–∏–≤–∞—î –Ω–æ–º–µ—Ä –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è.',
    parameters: z.object({
      orderId: z.string().describe('–ù–æ–º–µ—Ä –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, —Ñ–æ—Ä–º–∞—Ç: ORD-XXXXX'),
    }),
    execute: async ({ orderId }) => {
      return await orderService.getStatus(orderId);
    },
  }),

  escalateToHuman: tool({
    description: '–ü–µ—Ä–µ–¥–∞—î —Ä–æ–∑–º–æ–≤—É –æ–ø–µ—Ä–∞—Ç–æ—Ä—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –∫–æ–ª–∏: –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≥—Ä–æ—à–µ–π, —Å–∫–∞—Ä–≥–∞, –∞–±–æ –Ω–µ –º–æ–∂–µ—à –¥–æ–ø–æ–º–æ–≥—Ç–∏.',
    parameters: z.object({
      reason: z.string().describe('–ü—Ä–∏—á–∏–Ω–∞ –µ—Å–∫–∞–ª–∞—Ü—ñ—ó'),
      summary: z.string().describe('–ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏ –∫–ª—ñ—î–Ω—Ç–∞'),
    }),
    execute: async ({ reason, summary }) => {
      return await ticketService.escalate({ reason, summary });
    },
  }),
};
```

**–ê–Ω—Ç–∏–ø–∞—Ç–µ—Ä–Ω:** 20+ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –¥–µ –º–æ–¥–µ–ª—å –Ω–µ –º–æ–∂–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —è–∫–∏–π –æ–±—Ä–∞—Ç–∏. –Ø–∫—â–æ –≤–∏ —Å–∞–º—ñ –Ω–µ –º–æ–∂–µ—Ç–µ –º–∏—Ç—Ç—î–≤–æ –≤–∫–∞–∑–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–¥–∞—á—ñ ‚Äî –º–æ–¥–µ–ª—å —Ç–µ–∂ –Ω–µ –∑–º–æ–∂–µ.

### 3. Retrieved Data ‚Äî –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

–î–∞–Ω—ñ —è–∫—ñ –ø—ñ–¥—Ç—è–≥—É—é—Ç—å—Å—è –≤ –º–æ–º–µ–Ω—Ç –∑–∞–ø–∏—Ç—É —á–µ—Ä–µ–∑ RAG, MCP, –∞–±–æ API.

```typescript
// –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –î–ò–ù–ê–ú–Ü–ß–ù–û –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É
async function buildContext(userMessage: string, userId: string) {
  // RAG: —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏
  const relevantDocs = await vectorSearch(userMessage, { topK: 3 });
  
  // –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  const userProfile = await getUserProfile(userId);
  
  // –û—Å—Ç–∞–Ω–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (—è–∫—â–æ —î)
  const recentOrders = await getRecentOrders(userId, { limit: 3 });

  return `
## –†–µ–ª–µ–≤–∞–Ω—Ç–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑ –±–∞–∑–∏ –∑–Ω–∞–Ω—å
${relevantDocs.map(d => d.content).join('\n---\n')}

## –ü—Ä–æ—Ñ—ñ–ª—å –∫–ª—ñ—î–Ω—Ç–∞
- –Ü–º'—è: ${userProfile.name}
- –ü–ª–∞–Ω: ${userProfile.plan}
- –ö–ª—ñ—î–Ω—Ç –∑: ${userProfile.since}

## –û—Å—Ç–∞–Ω–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
${recentOrders.map(o => `- ${o.id}: ${o.status} (${o.date})`).join('\n')}
`;
}
```

**–ü—Ä–∏–Ω—Ü–∏–ø "Just in Time":** –ù–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–π –≤—Å–µ –Ω–∞–ø–µ—Ä–µ–¥. –¢—Ä–∏–º–∞–π –ª–µ–≥–∫—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ (ID, —à–ª—è—Ö–∏, URL) —ñ –ø—ñ–¥—Ç—è–≥—É–π –ø–æ–≤–Ω—ñ –¥–∞–Ω—ñ —á–µ—Ä–µ–∑ tools –∫–æ–ª–∏ –≤–æ–Ω–∏ —Ä–µ–∞–ª—å–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ.

### 4. Conversation History ‚Äî –ø–∞–º'—è—Ç—å —Ä–æ–∑–º–æ–≤–∏

–ù–µ –≤—Å—è —ñ—Å—Ç–æ—Ä—ñ—è –æ–¥–Ω–∞–∫–æ–≤–æ –∫–æ—Ä–∏—Å–Ω–∞. –î–æ–≤–≥—ñ —Ä–æ–∑–º–æ–≤–∏ –∑–∞–±—Ä—É–¥–Ω—é—é—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç ("context pollution").

```typescript
// ‚ùå –ù–∞—ó–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥: –≤—Å—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
const messages = await db.getMessages(conversationId);
// 200 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å √ó 500 —Ç–æ–∫–µ–Ω—ñ–≤ = 100K —Ç–æ–∫–µ–Ω—ñ–≤ ‚Äî –ø–æ–ª–æ–≤–∏–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞!

// ‚úÖ –†–æ–∑—É–º–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥: –æ—Å—Ç–∞–Ω–Ω—ñ N + —Ä–µ–∑—é–º–µ
async function getOptimizedHistory(conversationId: string) {
  const recentMessages = await db.getMessages(conversationId, { limit: 10 });
  
  if (recentMessages.length >= 10) {
    // –ì–µ–Ω–µ—Ä—É—î–º–æ —Ä–µ–∑—é–º–µ —Å—Ç–∞—Ä–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
    const olderMessages = await db.getMessages(conversationId, { offset: 10 });
    const summary = await summarizeConversation(olderMessages);
    
    return [
      { role: 'system', content: `–†–µ–∑—é–º–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —Ä–æ–∑–º–æ–≤–∏: ${summary}` },
      ...recentMessages,
    ];
  }
  
  return recentMessages;
}
```

Anthropic –Ω–∞–∑–∏–≤–∞—î —Ü–µ **compaction** ‚Äî —Å—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º –∫–ª—é—á–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

### 5. User Query ‚Äî –ø–æ—Ç–æ—á–Ω–∏–π –∑–∞–ø–∏—Ç

–ó–¥–∞–≤–∞–ª–æ—Å—å –±–∏, —Ç—É—Ç –Ω—ñ—á–æ–≥–æ —ñ–Ω–∂–µ–Ω–µ—Ä–∏—Ç–∏. –ê–ª–µ –Ω–∞–≤—ñ—Ç—å –∑–∞–ø–∏—Ç –º–æ–∂–Ω–∞ –∑–±–∞–≥–∞—Ç–∏—Ç–∏:

```typescript
// –ó–±–∞–≥–∞—á–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—É –º–µ—Ç–∞–¥–∞–Ω–∏–º–∏
function enrichQuery(rawQuery: string, metadata: RequestMetadata) {
  return `[${metadata.timestamp}] [${metadata.channel}] [${metadata.language}]
–ó–∞–ø–∏—Ç –∫–ª—ñ—î–Ω—Ç–∞: ${rawQuery}`;
}
```

---

## Context Budget ‚Äî –±—é–¥–∂–µ—Ç—É–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—ñ–≤

–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–µ –≤—ñ–∫–Ω–æ –æ–±–º–µ–∂–µ–Ω–µ. –ö–æ–∂–µ–Ω —Ç–æ–∫–µ–Ω –º–∞—î "–≤–∞—Ä—Ç—ñ—Å—Ç—å —É–≤–∞–≥–∏" ‚Äî —á–∏–º –±—ñ–ª—å—à–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, —Ç–∏–º –º–µ–Ω—à–µ –º–æ–¥–µ–ª—å —Ñ–æ–∫—É—Å—É—î—Ç—å—Å—è –Ω–∞ –∫–æ–∂–Ω—ñ–π —á–∞—Å—Ç–∏–Ω—ñ.

Dex Horthy (–∞–≤—Ç–æ—Ä "12 Factor Agents") –≤–∏—è–≤–∏–≤ **"–∑–æ–Ω—É –¥–µ–≥—Ä–∞–¥–∞—Ü—ñ—ó"**: –∫–æ–ª–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω–æ –±—ñ–ª—å—à–µ ~40% –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞, —è–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –ø–æ—á–∏–Ω–∞—î –ø–∞–¥–∞—Ç–∏.

```typescript
// –ë—é–¥–∂–µ—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
const CONTEXT_BUDGET = {
  systemPrompt: 2000,     // —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–π
  tools: 1500,            // —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–π
  retrievedData: 4000,    // –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π
  conversationHistory: 3000, // –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π
  userQuery: 500,         // –≤–∞—Ä—ñ–∞—Ç–∏–≤–Ω–∏–π
  responseBudget: 2000,   // –∑–∞–ª–∏—à–∞—î–º–æ –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
  // –†–∞–∑–æ–º: ~13000 —Ç–æ–∫–µ–Ω—ñ–≤ –∑ 200K ‚Äî –º–µ–Ω—à–µ 10%
};

// –§—É–Ω–∫—Ü—ñ—è —â–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—î –±—é–¥–∂–µ—Ç
function fitToTokenBudget(
  text: string,
  maxTokens: number,
  strategy: 'truncate' | 'summarize' = 'truncate'
): string {
  const estimated = estimateTokens(text);
  if (estimated <= maxTokens) return text;
  
  if (strategy === 'truncate') {
    // –û–±—Ä—ñ–∑–∞—î–º–æ –∑ –∫—ñ–Ω—Ü—è, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –ø–æ—á–∞—Ç–æ–∫
    return text.slice(0, maxTokens * 4) + '\n[...–æ–±—Ä—ñ–∑–∞–Ω–æ]';
  }
  // –î–ª—è summarize ‚Äî –æ–∫—Ä–µ–º–∏–π LLM-–≤–∏–∫–ª–∏–∫
  return summarize(text, maxTokens);
}
```

---

## –¢—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó –¥–ª—è –¥–æ–≤–≥–∏—Ö –≤–∑–∞—î–º–æ–¥—ñ–π

–ö–æ–ª–∏ –∞–≥–µ–Ω—Ç –ø—Ä–∞—Ü—é—î –¥–æ–≤–≥–æ (–¥–µ—Å—è—Ç–∫–∏ –∫—Ä–æ–∫—ñ–≤, –±–∞–≥–∞—Ç–æ tool calls), –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞–∫–æ–ø–∏—á—É—î—Ç—å—Å—è —ñ –¥–µ–≥—Ä–∞–¥—É—î. Anthropic –æ–ø–∏—Å—É—î —Ç—Ä–∏ –ø—ñ–¥—Ö–æ–¥–∏:

### 1. Compaction ‚Äî —Å—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

```typescript
// –ö–æ–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞–±–ª–∏–∂–∞—î—Ç—å—Å—è –¥–æ –ª—ñ–º—ñ—Ç—É ‚Äî —Å—Ç–∏—Å–∫–∞—î–º–æ
async function compactContext(messages: Message[]): Promise<Message[]> {
  const tokenCount = estimateTokens(JSON.stringify(messages));
  
  if (tokenCount < COMPACTION_THRESHOLD) return messages;
  
  const summary = await generateText({
    model: openai('gpt-4o-mini'), // –¥–µ—à–µ–≤–∞ –º–æ–¥–µ–ª—å –¥–ª—è —Å—Ç–∏—Å–∫–∞–Ω–Ω—è
    system: '–°—Ç–≤–æ—Ä–∏ —Å—Ç–∏—Å–ª–µ —Ä–µ–∑—é–º–µ —Ä–æ–∑–º–æ–≤–∏, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –≤—Å—ñ –∫–ª—é—á–æ–≤—ñ —Ñ–∞–∫—Ç–∏, —Ä—ñ—à–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–∏—Ç–∞–Ω–Ω—è.',
    prompt: JSON.stringify(messages),
  });
  
  return [
    { role: 'system', content: `–†–µ–∑—é–º–µ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —á–∞—Å—Ç–∏–Ω–∏ —Ä–æ–∑–º–æ–≤–∏:\n${summary.text}` },
    // –ó–∞–ª–∏—à–∞—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ 3-5 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –±–µ–∑ –∑–º—ñ–Ω
    ...messages.slice(-5),
  ];
}
```

### 2. Structured Note-Taking ‚Äî –Ω–æ—Ç–∞—Ç–∫–∏ –∞–≥–µ–Ω—Ç–∞

```typescript
// –ê–≥–µ–Ω—Ç –≤–µ–¥–µ "—â–æ–¥–µ–Ω–Ω–∏–∫" ‚Äî —Ñ–∞–π–ª –∑ –ø—Ä–æ–≥—Ä–µ—Å–æ–º
const notepadTool = tool({
  description: '–ó–∞–ø–∏—Å–∞—Ç–∏ –Ω–æ—Ç–∞—Ç–∫—É –ø—Ä–æ –ø—Ä–æ–≥—Ä–µ—Å –∑–∞–¥–∞—á—ñ. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–Ω–∞—á–Ω–æ–≥–æ –∫—Ä–æ–∫—É.',
  parameters: z.object({
    note: z.string().describe('–©–æ –∑—Ä–æ–±–ª–µ–Ω–æ, —â–æ –≤–∏—Ä—ñ—à–µ–Ω–æ, —â–æ –∑–∞–ª–∏—à–∏–ª–æ—Å—å'),
  }),
  execute: async ({ note }) => {
    await fs.appendFile('agent-progress.md', `\n- ${new Date().toISOString()}: ${note}`);
    return '–ù–æ—Ç–∞—Ç–∫—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ';
  },
});

// –ù–∞ –ø–æ—á–∞—Ç–∫—É –Ω–æ–≤–æ—ó —Å–µ—Å—ñ—ó ‚Äî —á–∏—Ç–∞—î–º–æ –Ω–æ—Ç–∞—Ç–∫–∏
const previousNotes = await fs.readFile('agent-progress.md', 'utf-8');
```

–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ Claude Code –¥–ª—è —Ä–æ–±–æ—Ç–∏ –Ω–∞–¥ –≤–µ–ª–∏–∫–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —á–µ—Ä–µ–∑ –∫—ñ–ª—å–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∏—Ö –≤—ñ–∫–æ–Ω.

### 3. Multi-agent –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

```typescript
// Lead agent –¥–µ–ª–µ–≥—É—î –ø—ñ–¥–∑–∞–¥–∞—á—É sub-agent –∑ –æ–∫—Ä–µ–º–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
async function researchWithSubAgent(query: string): Promise<string> {
  const { text } = await generateText({
    model: openai('gpt-4o-mini'),
    system: '–¢–∏ ‚Äî –¥–æ—Å–ª—ñ–¥–Ω–∏—Ü—å–∫–∏–π –∞–≥–µ–Ω—Ç. –ó–Ω–∞–π–¥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç —ñ –ø–æ–≤–µ—Ä–Ω–∏ —Å—Ç–∏—Å–ª–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.',
    prompt: query,
    tools: { webSearch, documentSearch },
    maxSteps: 5,
  });
  return text; // –¢—ñ–ª—å–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç lead agent
}
```

–î–µ—Ç–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—à—É–∫—É –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ sub-agent, –∞ lead agent –æ—Ç—Ä–∏–º—É—î —Ç—ñ–ª—å–∫–∏ —Å—Ç–∏—Å–ª–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ß–∏—Å—Ç–µ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ.

---

## Context Engineering –≤ –∫–æ–¥—ñ: –ø–æ–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥

```typescript
import { generateText, tool } from 'ai';
import { openai } from '@ai-sdk/openai';
import { z } from 'zod';

async function handleCustomerQuery(
  userMessage: string,
  conversationId: string,
  userId: string
) {
  // 1. System prompt ‚Äî –ø–æ—Å—Ç—ñ–π–Ω–∞ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å
  const systemPrompt = await loadSystemPrompt('customer-support-v3');

  // 2. –î–∏–Ω–∞–º—ñ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Äî "just in time"
  const context = await buildDynamicContext(userMessage, userId);

  // 3. –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ —ñ—Å—Ç–æ—Ä—ñ—è ‚Äî compaction –ø—Ä–∏ –ø–æ—Ç—Ä–µ–±—ñ
  const history = await getOptimizedHistory(conversationId);

  // 4. –ó–±–∏—Ä–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
  const { text, toolCalls } = await generateText({
    model: openai('gpt-4o-mini'),
    system: `${systemPrompt}\n\n${context}`,
    messages: [
      ...history,
      { role: 'user', content: userMessage },
    ],
    tools, // 5. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤
    maxSteps: 5,
  });

  // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
  await saveToHistory(conversationId, userMessage, text);
  
  return { text, toolCalls };
}
```

---

## –ß–µ–∫–ª–∏—Å—Ç: Context Engineering –¥–ª—è –≤–∞—à–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–≤—ñ–π AI-–∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫:

1. **System prompt** ‚Äî —á—ñ—Ç–∫—ñ –ø—Ä–∞–≤–∏–ª–∞, —Ç–æ–Ω, –æ–±–º–µ–∂–µ–Ω–Ω—è? –ù–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π edge cases?
2. **Tools** ‚Äî –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä –∑ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∏–º–∏ –æ–ø–∏—Å–∞–º–∏? –ö–æ–∂–µ–Ω tool –º–∞—î —á—ñ—Ç–∫—É –∑–æ–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ?
3. **Retrieved data** ‚Äî —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏, –Ω–µ –≤—Å–µ –ø—ñ–¥—Ä—è–¥? –Ñ token budget?
4. **History** ‚Äî —î compaction –∞–±–æ sliding window? –î–æ–≤–≥—ñ —Ä–æ–∑–º–æ–≤–∏ –Ω–µ –∑'—ó–¥–∞—é—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç?
5. **Few-shot examples** ‚Äî —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ, —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ñ, –≤–∫–ª—é—á–∞—é—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏?
6. **Token budget** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ —Å–∫—ñ–ª—å–∫–∏ —Ç–æ–∫–µ–Ω—ñ–≤ –≤–∏—Ç—Ä–∞—á–∞—î –∫–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç?

---

## –©–æ –¥–∞–ª—ñ

–í–∏ —Ç–µ–ø–µ—Ä —Ä–æ–∑—É–º—ñ—î—Ç–µ —â–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Äî —Ü–µ —ñ–Ω–∂–µ–Ω–µ—Ä–Ω–∏–π —Ä–µ—Å—É—Ä—Å, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–º–ø—Ç + –¥–∞–Ω—ñ". –ê–ª–µ –∫–æ–ª–∏ –º–æ–¥–µ–ª—å –æ—Ç—Ä–∏–º–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, —è–∫ –∑–º—É—Å–∏—Ç–∏ —ó—ó **–¥—É–º–∞—Ç–∏ –≥–ª–∏–±—à–µ** –Ω–∞–¥ —Å–∫–ª–∞–¥–Ω–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏? –°–∞–º–µ —Ü–µ —Ä–æ–±–ª—è—Ç—å Reasoning Models –∑ extended thinking ‚Äî [KB: Reasoning Models](../kb/advanced/reasoning-models-reference.md) (coming soon).

–ü–æ–≤–Ω–∏–π –¥–æ–≤—ñ–¥–Ω–∏–∫ –∑ –ø–∞—Ç–µ—Ä–Ω–∞–º–∏ —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏: [KB: Context Engineering Deep Dive](../kb/advanced/context-engineering-deep-dive.md)

---

## –î–∂–µ—Ä–µ–ª–∞

- [Anthropic ‚Äî Effective context engineering for AI agents](https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents) (–≤–µ—Ä–µ—Å–µ–Ω—å 2025)
- [Anthropic ‚Äî Effective harnesses for long-running agents](https://www.anthropic.com/engineering/effective-harnesses-for-long-running-agents)
- [12 Factor Agents ‚Äî Dex Horthy](https://github.com/humanlayer/12-factor-agents)
- [Context Engineering Guide ‚Äî PromptingGuide.ai](https://www.promptingguide.ai/guides/context-engineering-guide)
