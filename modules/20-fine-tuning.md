# –ú–æ–¥—É–ª—å 20: Fine-tuning —Ç–∞ Model Distillation

## üéØ –©–æ –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∑ —Ü—å–æ–≥–æ –º–æ–¥—É–ª—è

–ü—ñ—Å–ª—è –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –≤–∏ –±—É–¥–µ—Ç–µ:
- –†–æ–∑—É–º—ñ—Ç–∏ –∫–æ–ª–∏ fine-tuning –¥–∞—î –ø–µ—Ä–µ–≤–∞–≥—É –Ω–∞–¥ prompting —Ç–∞ RAG
- –°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ training dataset –∑ production-–ª–æ–≥—ñ–≤
- –ó–∞–ø—É—Å–∫–∞—Ç–∏ fine-tuning —á–µ—Ä–µ–∑ OpenAI API
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ model distillation –¥–ª—è –∑–Ω–∏–∂–µ–Ω–Ω—è –≤–∞—Ä—Ç–æ—Å—Ç—ñ —É 40-200 —Ä–∞–∑—ñ–≤

**–Ø–∫—ñ –∑–∞–¥–∞—á—ñ —Ü–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏:** –ö–æ–ª–∏ –ø—Ä–æ–º–ø—Ç-—ñ–Ω–∂–µ–Ω–µ—Ä—ñ—è –¥–æ—Å—è–≥–ª–∞ —Å—Ç–µ–ª—ñ —è–∫–æ—Å—Ç—ñ. –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –∞–±–æ —Ñ–æ—Ä–º–∞—Ç —è–∫—É –∑–∞–≥–∞–ª—å–Ω–∞ –º–æ–¥–µ–ª—å –Ω–µ –¥–∞—î. –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –¥–æ—Ä–æ–≥—É –º–æ–¥–µ–ª—å ($15/1M) –Ω–∞ –¥–µ—à–µ–≤—É ($0.15/1M) –∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º —è–∫–æ—Å—Ç—ñ.

---

## 20.1 Prompting vs RAG vs Fine-tuning: –ö–æ–ª–∏ —â–æ

```
–ü—Ä–æ–±–ª–µ–º–∞: –º–æ–¥–µ–ª—å –Ω–µ –∑–Ω–∞—î –≤–∞—à—ñ –¥–∞–Ω—ñ
‚Üí RAG (–¥–æ–¥–∞–π—Ç–µ –¥–∞–Ω—ñ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç)

–ü—Ä–æ–±–ª–µ–º–∞: –º–æ–¥–µ–ª—å –Ω–µ —Ç—Ä–∏–º–∞—î –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç/—Å—Ç–∏–ª—å
‚Üí Fine-tuning (–Ω–∞–≤—á—ñ—Ç—å –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥–∞—Ö)

–ü—Ä–æ–±–ª–µ–º–∞: –º–æ–¥–µ–ª—å –Ω–µ –º–∞—î –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –∑–Ω–∞–Ω—å + –Ω–µ —Ç—Ä–∏–º–∞—î —Å—Ç–∏–ª—å
‚Üí RAG + Fine-tuning (–∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è)
```

| –ö—Ä–∏—Ç–µ—Ä—ñ–π | Prompting | RAG | Fine-tuning |
|----------|-----------|-----|-------------|
| –ß–∞—Å –Ω–∞ –∑–∞–ø—É—Å–∫ | –•–≤–∏–ª–∏–Ω–∏ | –î–Ω—ñ | –î–Ω—ñ-—Ç–∏–∂–Ω—ñ |
| –ü–æ—Ç—Ä—ñ–±–µ–Ω dataset | –ù—ñ | –î–æ–∫—É–º–µ–Ω—Ç–∏ | 50-10,000+ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ |
| –ù–æ–≤—ñ –¥–∞–Ω—ñ | –û–¥—Ä–∞–∑—É | –ü—ñ—Å–ª—è –ø–µ—Ä–µ—ñ–Ω–¥–µ–∫—Å–∞—Ü—ñ—ó | –ü—ñ—Å–ª—è –ø–µ—Ä–µ–Ω–∞–≤—á–∞–Ω–Ω—è |
| –í–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞–ø—É—Å–∫—É | $0 | Embedding + DB | $5-500 –∑–∞ –Ω–∞–≤—á–∞–Ω–Ω—è |
| –í–∞—Ä—Ç—ñ—Å—Ç—å —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É | –ë–∞–∑–æ–≤–∞ | –ë–∞–∑–æ–≤–∞ + embedding | –ú–æ–∂–µ –±—É—Ç–∏ –¥–µ—à–µ–≤—à–æ—é |
| –Ø–∫—ñ—Å—Ç—å –Ω–∞ –≤—É–∑—å–∫—ñ–π –∑–∞–¥–∞—á—ñ | –°–µ—Ä–µ–¥–Ω—è | –í–∏—Å–æ–∫–∞ (—Ñ–∞–∫—Ç–∏) | –ù–∞–π–≤–∏—â–∞ (—Å—Ç–∏–ª—å + —Ñ–∞–∫—Ç–∏) |

### –ö–æ–ª–∏ fine-tuning –¥–∞—î —Ä–µ–∞–ª—å–Ω—É –ø–µ—Ä–µ–≤–∞–≥—É

**–¢–∞–∫, fine-tuning –ø–æ—Ç—Ä—ñ–±–µ–Ω –∫–æ–ª–∏:**
- –ü–æ—Ç—Ä—ñ–±–µ–Ω —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –≤–∏—Ö–æ–¥—É —è–∫–∏–π –ø—Ä–æ–º–ø—Ç –Ω–µ –∑–∞–±–µ–∑–ø–µ—á—É—î —Å—Ç–∞–±—ñ–ª—å–Ω–æ
- –ú–æ–¥–µ–ª—å –º–∞—î —Å–ª—ñ–¥—É–≤–∞—Ç–∏ brand voice / tone of voice –¥—É–∂–µ —Ç–æ—á–Ω–æ
- –ü–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–≤—á–∏—Ç–∏ –º–æ–¥–µ–ª—å –Ω–∞ domain-specific —Ç–µ—Ä–º—ñ–Ω–æ–ª–æ–≥—ñ—ó (–º–µ–¥–∏—Ü–∏–Ω–∞, —é—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü—ñ—è)
- –í–∞—Ä—Ç—ñ—Å—Ç—å —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—É –∫—Ä–∏—Ç–∏—á–Ω–∞ (fine-tuned GPT-4o-mini –º–æ–∂–µ –∑–∞–º—ñ–Ω–∏—Ç–∏ GPT-4o)
- –õ–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–Ω–∞ (–º–µ–Ω—à–∏–π –ø—Ä–æ–º–ø—Ç ‚Üí —à–≤–∏–¥—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å)

**–ù—ñ, fine-tuning –ù–ï –ø–æ—Ç—Ä—ñ–±–µ–Ω –∫–æ–ª–∏:**
- –ú–æ–¥–µ–ª—å –Ω–µ –∑–Ω–∞—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ñ–∞–∫—Ç–∏ ‚Üí –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ RAG
- Few-shot –ø—Ä–æ–º–ø—Ç –≤–∂–µ –¥–∞—î 90%+ —è–∫–æ—Å—Ç—ñ ‚Üí –∑–∞–ª–∏—à–∞–π—Ç–µ—Å—å –Ω–∞ –ø—Ä–æ–º–ø—Ç–∞—Ö
- –î–∞–Ω—ñ —á–∞—Å—Ç–æ –∑–º—ñ–Ω—é—é—Ç—å—Å—è ‚Üí RAG –≥–Ω—É—á–∫—ñ—à–µ
- –£ –≤–∞—Å –º–µ–Ω—à–µ 50 –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ ‚Üí –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è

---

## 20.2 –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ Training Dataset

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö (OpenAI JSONL)

```jsonl
{"messages": [{"role": "system", "content": "–¢–∏ ‚Äî –∞—Å–∏—Å—Ç–µ–Ω—Ç TechShop."}, {"role": "user", "content": "–î–µ –º–æ—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?"}, {"role": "assistant", "content": "–î—è–∫—É—é –∑–∞ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è! –î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å—É –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, –±—É–¥—å –ª–∞—Å–∫–∞, –Ω–∞–¥–∞–π—Ç–µ –Ω–æ–º–µ—Ä –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (—Ñ–æ—Ä–º–∞—Ç: ORD-XXXXXX). –Ø –æ–¥—Ä–∞–∑—É –ø–µ—Ä–µ–≤—ñ—Ä—é –¥–ª—è –≤–∞—Å."}]}
{"messages": [{"role": "system", "content": "–¢–∏ ‚Äî –∞—Å–∏—Å—Ç–µ–Ω—Ç TechShop."}, {"role": "user", "content": "–•–æ—á—É –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —Ç–æ–≤–∞—Ä"}, {"role": "assistant", "content": "–†–æ–∑—É–º—ñ—é, —â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –æ—Ñ–æ—Ä–º–∏—Ç–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –Ω–∞—à–æ—ó –ø–æ–ª—ñ—Ç–∏–∫–∏, –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–µ –ø—Ä–æ—Ç—è–≥–æ–º 14 –¥–Ω—ñ–≤ –∑ –º–æ–º–µ–Ω—Ç—É –æ—Ç—Ä–∏–º–∞–Ω–Ω—è. –ü—ñ–¥–∫–∞–∂—ñ—Ç—å, –±—É–¥—å –ª–∞—Å–∫–∞, –Ω–æ–º–µ—Ä –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –ø—Ä–∏—á–∏–Ω—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è?"}]}
```

### –ó–±—ñ—Ä –¥–∞–Ω–∏—Ö –∑ production-–ª–æ–≥—ñ–≤

```typescript
import { readFileSync, writeFileSync } from 'fs';

interface ConversationLog {
  messages: Array<{ role: string; content: string }>;
  rating: number; // –û—Ü—ñ–Ω–∫–∞ —è–∫–æ—Å—Ç—ñ –≤—ñ–¥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞/–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  category: string;
}

function createTrainingDataset(logs: ConversationLog[]): string {
  // –§—ñ–ª—å—Ç—Ä—É—î–º–æ: —Ç—ñ–ª—å–∫–∏ –≤–∏—Å–æ–∫–æ –æ—Ü—ñ–Ω–µ–Ω—ñ —Ä–æ–∑–º–æ–≤–∏
  const goodExamples = logs
    .filter(log => log.rating >= 4) // 4-5 –∑—ñ—Ä–æ–∫
    .filter(log => log.messages.length >= 2);

  // –§–æ—Ä–º–∞—Ç JSONL
  const lines = goodExamples.map(log => {
    const messages = log.messages.map(m => ({
      role: m.role,
      content: m.content,
    }));
    return JSON.stringify({ messages });
  });

  return lines.join('\n');
}

// –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è
const dataset = createTrainingDataset(productionLogs);
writeFileSync('training-data.jsonl', dataset);
console.log(`–°—Ç–≤–æ—Ä–µ–Ω–æ ${dataset.split('\n').length} –ø—Ä–∏–∫–ª–∞–¥—ñ–≤`);
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –ø–æ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤

| –ó–∞–¥–∞—á–∞ | –ú—ñ–Ω—ñ–º—É–º | –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ | –Ü–¥–µ–∞–ª—å–Ω–æ |
|--------|---------|--------------|----------|
| –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è (5 –∫–∞—Ç–µ–≥–æ—Ä—ñ–π) | 50 | 200 | 500+ |
| –°—Ç–∏–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π | 100 | 500 | 1,000+ |
| Domain-specific –∑–Ω–∞–Ω–Ω—è | 200 | 1,000 | 5,000+ |
| –°–∫–ª–∞–¥–Ω—ñ multi-turn –¥—ñ–∞–ª–æ–≥–∏ | 500 | 2,000 | 10,000+ |

---

## 20.3 –ó–∞–ø—É—Å–∫ Fine-tuning —á–µ—Ä–µ–∑ OpenAI API

```typescript
import OpenAI from 'openai';
import { createReadStream } from 'fs';

const client = new OpenAI();

// –ö—Ä–æ–∫ 1: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É
const file = await client.files.create({
  file: createReadStream('training-data.jsonl'),
  purpose: 'fine-tune',
});
console.log(`–§–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ: ${file.id}`);

// –ö—Ä–æ–∫ 2: –ó–∞–ø—É—Å–∫ fine-tuning
const job = await client.fineTuning.jobs.create({
  training_file: file.id,
  model: 'gpt-4o-mini-2024-07-18',  // –ë–∞–∑–æ–≤–∞ –º–æ–¥–µ–ª—å
  hyperparameters: {
    n_epochs: 3,  // –ö—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ø–æ—Ö (2-5 –∑–∞–∑–≤–∏—á–∞–π –¥–æ—Å—Ç–∞—Ç–Ω—å–æ)
  },
  suffix: 'techshop-support-v1',  // –°—É—Ñ—ñ–∫—Å –¥–ª—è –Ω–∞–∑–≤–∏ –º–æ–¥–µ–ª—ñ
});
console.log(`Job —Å—Ç–≤–æ—Ä–µ–Ω–æ: ${job.id}`);

// –ö—Ä–æ–∫ 3: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—É
let status = job.status;
while (status !== 'succeeded' && status !== 'failed') {
  await new Promise(r => setTimeout(r, 30_000)); // –ß–µ–∫–∞—î–º–æ 30 —Å–µ–∫
  const updated = await client.fineTuning.jobs.retrieve(job.id);
  status = updated.status;
  console.log(`–°—Ç–∞—Ç—É—Å: ${status}`);
}

// –ö—Ä–æ–∫ 4: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è fine-tuned –º–æ–¥–µ–ª—ñ
if (status === 'succeeded') {
  const completed = await client.fineTuning.jobs.retrieve(job.id);
  const modelName = completed.fine_tuned_model!;
  console.log(`–ú–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞: ${modelName}`);

  // –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ‚Äî —Ç–∞–∫ —Å–∞–º–æ —è–∫ –∑–≤–∏—á–∞–π–Ω–∞ –º–æ–¥–µ–ª—å
  const { text } = await generateText({
    model: openai(modelName),  // 'ft:gpt-4o-mini-2024-07-18:org:techshop-support-v1:abc123'
    prompt: '–î–µ –º–æ—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?',
  });
}
```

### –í–∞—Ä—Ç—ñ—Å—Ç—å fine-tuning

| –ú–æ–¥–µ–ª—å | –ù–∞–≤—á–∞–Ω–Ω—è (–∑–∞ 1M —Ç–æ–∫–µ–Ω—ñ–≤) | –Ü–Ω—Ñ–µ—Ä–µ–Ω—Å (–≤—Ö—ñ–¥/–≤–∏—Ö—ñ–¥ –∑–∞ 1M) |
|--------|-------------------------|---------------------------|
| GPT-4o-mini | $3.00 | $0.30 / $1.20 (2x –±–∞–∑–æ–≤–æ—ó) |
| GPT-4o | $25.00 | $3.75 / $15.00 |

–ü—Ä–∏–∫–ª–∞–¥: 1000 –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ √ó 500 —Ç–æ–∫–µ–Ω—ñ–≤ = 500K —Ç–æ–∫–µ–Ω—ñ–≤ –Ω–∞–≤—á–∞–Ω–Ω—è ‚âà **$1.50** –¥–ª—è GPT-4o-mini.

### Fine-tuning —É —ñ–Ω—à–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤

Fine-tuning ‚Äî –æ–¥–Ω–∞ –∑ –æ–±–ª–∞—Å—Ç–µ–π –¥–µ API **–Ω–∞–π–±—ñ–ª—å—à —Ä—ñ–∑–Ω—ñ** –º—ñ–∂ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏:

```typescript
// Google Gemini ‚Äî fine-tuning —á–µ—Ä–µ–∑ Vertex AI
// –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö ‚Äî —ñ–Ω—à–∏–π (–Ω–µ JSONL –∑ messages, –∞ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π):
// {"text_input": "–ö–ª–∞—Å–∏—Ñ—ñ–∫—É–π: –Ω–µ –º–æ–∂—É –æ–ø–ª–∞—Ç–∏—Ç–∏", "output": "billing"}

// Google –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î tuningJobs API:
const tuningResponse = await fetch(
  `https://${REGION}-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/${REGION}/tuningJobs`,
  {
    method: 'POST',
    headers: { 'Authorization': `Bearer ${GOOGLE_TOKEN}`, 'Content-Type': 'application/json' },
    body: JSON.stringify({
      baseModel: 'gemini-2.0-flash-001',
      supervisedTuningSpec: {
        trainingDatasetUri: 'gs://your-bucket/training-data.jsonl',
        hyperParameters: { epochCount: 3, learningRateMultiplier: 1.0 },
      },
    }),
  }
);
```

**Anthropic** –Ω–µ –ø—Ä–æ–ø–æ–Ω—É—î –ø—É–±–ª—ñ—á–Ω–∏–π fine-tuning API ‚Äî –Ω–∞—Ç–æ–º—ñ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—î:
- Prompt engineering + few-shot examples (–º–æ–¥—É–ª—å 04)
- Extended Thinking –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–¥–∞—á
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Voyage AI embeddings –¥–ª—è RAG

| –ê—Å–ø–µ–∫—Ç | OpenAI | Google Gemini | Anthropic |
|--------|--------|---------------|-----------|
| Fine-tuning API | ‚úÖ –ü–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π | ‚úÖ –ß–µ—Ä–µ–∑ Vertex AI | ‚ùå –ù–µ–º–∞—î –ø—É–±–ª—ñ—á–Ω–æ–≥–æ |
| –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö | JSONL (messages) | JSONL (text_input/output) | ‚Äî |
| –ü—ñ–¥—Ç—Ä–∏–º–∞–Ω—ñ –º–æ–¥–µ–ª—ñ | GPT-4o, GPT-4o-mini | Gemini Flash, Gemini Pro | ‚Äî |
| –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ | ‚Äî | ‚Äî | Prompt engineering + RAG |
| –ú—ñ–Ω. –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ | 10 (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ 50+) | 100+ | ‚Äî |
| Distillation | ‚úÖ (stored completions) | ‚úÖ | ‚ùå |

---

## 20.4 Model Distillation: –î–µ—à–µ–≤–∞ –º–æ–¥–µ–ª—å –∑ —è–∫—ñ—Å—Ç—é –¥–æ—Ä–æ–≥–æ—ó

Distillation ‚Äî —Ü–µ –∫–æ–ª–∏ –≤–∏ –Ω–∞–≤—á–∞—î—Ç–µ –º–∞–ª–µ–Ω—å–∫—É –º–æ–¥–µ–ª—å –Ω–∞ –≤–∏—Ö–æ–¥–∞—Ö –≤–µ–ª–∏–∫–æ—ó:

```
1. GPT-5 ($1.25/1M) –≥–µ–Ω–µ—Ä—É—î 10,000 –µ—Ç–∞–ª–æ–Ω–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
2. Fine-tune GPT-4o-mini ($0.15/1M) –Ω–∞ —Ü–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥—è—Ö
3. GPT-4o-mini —Ç–µ–ø–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –º–∞–π–∂–µ —è–∫ GPT-5
4. –ï–∫–æ–Ω–æ–º—ñ—è: ~8x –Ω–∞ —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—ñ
```

```typescript
// –ö—Ä–æ–∫ 1: –ì–µ–Ω–µ—Ä—É—î–º–æ –µ—Ç–∞–ª–æ–Ω–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤–µ–ª–∏–∫–æ—é –º–æ–¥–µ–ª–ª—é
async function generateTeacherData(inputs: string[]): Promise<string> {
  const lines: string[] = [];

  for (const input of inputs) {
    const { text } = await generateText({
      model: openai('gpt-5'),  // "–í—á–∏—Ç–µ–ª—å" ‚Äî –Ω–∞–π—Ä–æ–∑—É–º–Ω—ñ—à–∞ –º–æ–¥–µ–ª—å
      system: PRODUCTION_SYSTEM_PROMPT,
      prompt: input,
      temperature: 0,
    });

    lines.push(JSON.stringify({
      messages: [
        { role: 'system', content: PRODUCTION_SYSTEM_PROMPT },
        { role: 'user', content: input },
        { role: 'assistant', content: text },
      ],
    }));
  }

  return lines.join('\n');
}

// –ö—Ä–æ–∫ 2: Fine-tune –¥–µ—à–µ–≤—É –º–æ–¥–µ–ª—å –Ω–∞ —Ü–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥—è—Ö
// ‚Üí –¢–µ–ø–µ—Ä GPT-4o-mini –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ —Ä—ñ–≤–Ω—ñ GPT-5 –¥–ª—è –í–ê–®–û–á –∑–∞–¥–∞—á—ñ
```

### ROI Distillation

```
–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è training data: 10,000 –∑–∞–ø–∏—Ç—ñ–≤ √ó GPT-5 = ~$30
Fine-tuning GPT-4o-mini: ~$5
–†–∞–∑–æ–º: $35 –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ

–ï–∫–æ–Ω–æ–º—ñ—è –Ω–∞ —ñ–Ω—Ñ–µ—Ä–µ–Ω—Å—ñ:
  GPT-5: $1.25/1M tokens √ó 100K –∑–∞–ø–∏—Ç—ñ–≤/–º—ñ—Å = $125/–º—ñ—Å
  Fine-tuned GPT-4o-mini: $0.30/1M √ó 100K = $30/–º—ñ—Å
  –ï–∫–æ–Ω–æ–º—ñ—è: $95/–º—ñ—Å ‚Üí $1,140/—Ä—ñ–∫
  ROI: 32x –∑–∞ –ø–µ—Ä—à–∏–π —Ä—ñ–∫
```

---

## 20.5 Evaluation: –ß–∏ —Å—Ç–∞–≤ fine-tuning –∫—Ä–∞—â–µ?

–ó–∞–≤–∂–¥–∏ –ø–æ—Ä—ñ–≤–Ω—é–π—Ç–µ –∑ –±–∞–∑–æ–≤–æ—é –º–æ–¥–µ–ª–ª—é:

```typescript
async function compareFinetuned(testCases: Array<{ input: string; expected: string }>) {
  const models = [
    { name: 'Base GPT-4o-mini', id: 'gpt-4o-mini' },
    { name: 'Fine-tuned', id: 'ft:gpt-4o-mini:...' },
    { name: 'Teacher GPT-5', id: 'gpt-5' },
  ];

  for (const tc of testCases) {
    console.log(`\nInput: "${tc.input}"`);
    for (const model of models) {
      const { text } = await generateText({
        model: openai(model.id),
        prompt: tc.input,
        temperature: 0,
      });
      const score = await llmJudge(tc.input, text); // –ó –º–æ–¥—É–ª—è 16
      console.log(`  ${model.name}: ${score.relevance}/5 ‚Äî ${text.slice(0, 80)}...`);
    }
  }
}
```

---

## –ü–µ—Ä–µ–≤—ñ—Ä —Å–µ–±–µ

1. –ö–æ–ª–∏ fine-tuning –∫—Ä–∞—â–µ –∑–∞ RAG? –ö–æ–ª–∏ RAG –∫—Ä–∞—â–µ?
2. –°–∫—ñ–ª—å–∫–∏ –º—ñ–Ω—ñ–º—É–º –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è fine-tuning –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞?
3. –©–æ —Ç–∞–∫–µ model distillation —ñ —è–∫—É –µ–∫–æ–Ω–æ–º—ñ—é —Ü–µ –¥–∞—î?
4. –ü—ñ–¥–≥–æ—Ç—É–π—Ç–µ 10 –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ training data –¥–ª—è –∑–∞–¥–∞—á—ñ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç—ñ–∫–µ—Ç—ñ–≤
5. –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ fine-tuned –º–æ–¥–µ–ª—å –¥—ñ–π—Å–Ω–æ —Å—Ç–∞–ª–∞ –∫—Ä–∞—â–µ?

---

**–ù–∞–∑–∞–¥:** [‚Üê –ú–æ–¥—É–ª—å 19 ‚Äî Agentic RAG](19-agentic-rag.md) | **–î–∞–ª—ñ:** [–ú–æ–¥—É–ª—å 21 ‚Äî Voice —Ç–∞ Realtime API ‚Üí](21-voice-realtime.md)
